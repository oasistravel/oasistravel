
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø² | Oasis Travel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Cairo', sans-serif; background-color: #f4f4f4; }
    .sidebar {
      width: 260px; background-color: #e07b00;
      position: fixed; top: 0; bottom: 0; right: 0;
      padding: 20px; overflow-y: auto; color: white;
    }
    .sidebar h4 { color: #fff; text-align: center; margin-bottom: 20px; }
    .sidebar a {
      color: white; display: block; padding: 8px 10px; margin-bottom: 5px;
      text-decoration: none; border-radius: 6px;
    }
    .sidebar a:hover { background-color: #c96c00; }
    .main { margin-right: 270px; padding: 30px; }

    input, select, textarea, button {
      width: 100%; padding: 10px; margin: 10px 0;
    }
    form { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #ccc; max-width: 600px; margin: auto; }
    .logo { width: 100px; display: block; margin: 0 auto 15px; }
  </style>
</head>
<body>

<div class="sidebar">
  <img src="/logo.png" alt="Oasis Logo" class="logo" />
  <h4>Oasis Travel</h4>

  <a href="/dashboard.html">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a data-bs-toggle="collapse" href="#resMenu">ğŸ“ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</a>
  <div class="collapse" id="resMenu">
    <a href="/dashboard_add_reservation.html" class="ms-3">â• Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø²</a>
    <a href="/invoice_report.html" class="ms-3">ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙˆØ§ØªÙŠØ±</a>
  </div>

  <a data-bs-toggle="collapse" href="#transMenu">ğŸšŒ Ø§Ù„Ù†Ù‚Ù„</a>
  <div class="collapse" id="transMenu">
    <a href="/hiace_chart.html" class="ms-3">Ø´Ø§Ø±Øª Ù‡Ø§ÙŠ Ø§Ø³</a>
    <a href="/room_chart.html" class="ms-3">Ø´Ø§Ø±Øª Ø§Ù„ØºØ±Ù</a>
  </div>

  <a data-bs-toggle="collapse" href="#accMenu">ğŸ’° Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
  <div class="collapse" id="accMenu">
    <a href="/finance_report.html" class="ms-3">ğŸ“† ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ</a>
    <a href="/monthly_report.html" class="ms-3">ğŸ“… ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ</a>
    <a href="/add_expense.html" class="ms-3">â• Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ</a>
  </div>

  <a data-bs-toggle="collapse" href="#hrMenu">ğŸ§‘â€ğŸ’¼ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</a>
  <div class="collapse" id="hrMenu">
    <a href="/hr_module_protected.html" class="ms-3">Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</a>
  </div>

  <a data-bs-toggle="collapse" href="#comMenu">ğŸ¢ Ø§Ù„Ø´Ø±ÙƒØ§Øª</a>
  <div class="collapse" id="comMenu">
    <a href="/companies_module.html" class="ms-3">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª</a>
    <a href="/reports-company.html" class="ms-3">ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ø±ÙƒØ§Øª</a>
  </div>
</div>

<div class="main">
  <h4 class="mb-4">â• Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯</h4>
  <form id="reservationForm">
    <input type="text" id="customerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„" required />
    <input type="text" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„" required />
    <input type="date" id="travelDate" required />
    <input type="date" id="returnDate" required />

    <select id="city"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option></select>
    <select id="hotel"><option value="">Ø§Ø®ØªØ± Ø§Ù„ÙÙ†Ø¯Ù‚</option></select>
    <select id="company"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ©</option></select>

    <input type="text" id="roomNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„ØºØ±ÙØ©" />
    <input type="text" id="seatNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…Ù‚Ø¹Ø¯" />
    <input type="number" id="price" placeholder="Ø³Ø¹Ø± Ø§Ù„ÙØ±Ø¯" />
    <input type="number" id="paid" placeholder="Ø§Ù„Ù…Ø¯ÙÙˆØ¹" />

    <select id="paymentMethod">
      <option value="Ù†Ù‚Ø¯ÙŠ">Ù†Ù‚Ø¯ÙŠ</option>
      <option value="ØªØ­ÙˆÙŠÙ„">ØªØ­ÙˆÙŠÙ„</option>
    </select>

    <input type="text" id="receiver" placeholder="Ø§Ù„Ù…Ø³ØªÙ„Ù…" />
    <textarea id="notes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª"></textarea>

    <button type="submit">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­Ø¬Ø²</button>
  </form>
</div>

<script>
function fillDropdowns() {
  fetch('/api/hotels').then(res => res.json()).then(data => {
    const hotelSelect = document.getElementById("hotel");
    data.forEach(h => {
      const opt = document.createElement("option");
      opt.value = h._id;
      opt.textContent = h.name;
      hotelSelect.appendChild(opt);
    });
  });

  fetch('/api/companies').then(res => res.json()).then(data => {
    const companySelect = document.getElementById("company");
    data.forEach(c => {
      const opt = document.createElement("option");
      opt.value = c._id;
      opt.textContent = c.name;
      companySelect.appendChild(opt);
    });
  });
}

document.getElementById("reservationForm").addEventListener("submit", function(e) {
  e.preventDefault();
  const data = {
    customer: document.getElementById("customerName").value,
    phone: document.getElementById("phone").value,
    travelDate: document.getElementById("travelDate").value,
    returnDate: document.getElementById("returnDate").value,
    city: document.getElementById("city").value,
    hotel: document.getElementById("hotel").value,
    company: document.getElementById("company").value,
    roomNumber: document.getElementById("roomNumber").value,
    seatNumber: document.getElementById("seatNumber").value,
    price: parseFloat(document.getElementById("price").value),
    paid: parseFloat(document.getElementById("paid").value),
    paymentMethod: document.getElementById("paymentMethod").value,
    receiver: document.getElementById("receiver").value,
    notes: document.getElementById("notes").value
  };

  fetch('/api/reservations', {
    method: "POST",
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  }).then(() => {
    alert("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø­Ø¬Ø²");
    this.reset();
  });
});

window.onload = fillDropdowns;
</script>

<script src="/role-check.js"></script>
<script>protectPage(["admin", "sales"])</script>
</body>
</html>
